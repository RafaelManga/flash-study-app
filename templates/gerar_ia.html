{% extends "base.html" %}
{% block title %}Gerar com IA - FlashStudy{% endblock %}

{% block content %}
<div class="card" style="max-width: 640px; margin: 0 auto;">
    <h2>🤖 Gerar Cards com Inteligência Artificial</h2>
    <p style="color: var(--muted); margin-bottom: 24px;">
        Use a IA para criar flashcards personalizados sobre qualquer tema!
    </p>

    {% if not pode_usar_ia %}
        <div class="flash warning" style="margin-bottom: 24px;">
            ⏳ Aguarde <strong id="countdown">{{ tempo_restante }}</strong> segundos antes de gerar novos cards.
            <small>Isso evita sobrecarga do sistema e garante qualidade.</small>
        </div>
    {% endif %}

    <form method="post" class="form" {% if not pode_usar_ia %}style="opacity: 0.6; pointer-events: none;"{% endif %}>
        <div class="form-group">
            <label for="tema">Tema dos Cards</label>
            <input type="text" id="tema" name="tema" placeholder="Ex: História do Brasil, Matemática Básica, Inglês..." required {% if not pode_usar_ia %}disabled{% endif %}>
            <small style="color: var(--muted); font-size: 0.85rem;">
                Seja específico para melhores resultados
            </small>
        </div>

        <div class="form-group">
            <label for="quantidade">Quantidade de Cards</label>
            <select id="quantidade" name="quantidade" required {% if not pode_usar_ia %}disabled{% endif %}>
                <option value="5">5 cards</option>
                <option value="8" selected>8 cards</option>
                <option value="10">10 cards</option>
                <option value="15">15 cards (máximo)</option>
            </select>
        </div>

        <div class="form-group">
            <label for="nome_baralho">Nome do Baralho</label>
            <input type="text" id="nome_baralho" name="nome_baralho" placeholder="Ex: História - Período Colonial" required {% if not pode_usar_ia %}disabled{% endif %}>
        </div>

        <div class="form-actions">
            <button class="btn purple" type="submit" {% if not pode_usar_ia %}disabled{% endif %}>
                ✨ Gerar com IA
            </button>
            <a href="{{ url_for('home') }}" class="btn ghost">Cancelar</a>
        </div>
    </form>
</div>

<div class="card" style="max-width: 640px; margin: 24px auto 0;">
    <h3>💡 Dicas para melhores resultados:</h3>
    <ul style="color: var(--muted); line-height: 1.6;">
        <li><strong>Seja específico:</strong> "Verbos irregulares em inglês" ao invés de só "inglês"</li>
        <li><strong>Mencione o nível:</strong> "Matemática - 9º ano" para conteúdo adequado</li>
        <li><strong>Use contexto:</strong> "Revolução Francesa - causas e consequências"</li>
        <li><strong>Evite temas muito amplos:</strong> Prefira tópicos focados</li>
    </ul>
</div>

<div class="card" style="max-width: 640px; margin: 24px auto 0;">
    <h3>⚡ Limites da IA:</h3>
    <div style="display: grid; gap: 12px; color: var(--muted); line-height: 1.6;">
        <div>🕐 <strong>Cooldown:</strong> 2 minutos entre gerações</div>
        <div>📊 <strong>Máximo:</strong> 15 cards por geração</div>
        <div>🎯 <strong>Qualidade:</strong> Temas específicos geram melhores cards</div>
        <div>🔄 <strong>Gratuito:</strong> Sem limites diários, apenas cooldown</div>
    </div>
</div>

{% if not pode_usar_ia %}
<script>
    let timeLeft = {{ tempo_restante }};
    const countdown = document.getElementById('countdown');
    const form = document.querySelector('form');

    const timer = setInterval(() => {
        timeLeft--;
        countdown.textContent = timeLeft;

        if (timeLeft <= 0) {
            clearInterval(timer);
            location.reload(); // Recarrega a página quando o cooldown termina
        }
    }, 1000);
</script>
{% endif %}
{% endblock %}